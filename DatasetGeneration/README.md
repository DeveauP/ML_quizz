Here are how the dataset are generated and a quick solution on how to solve the exercise.

Detailed solutions will be coming later.